<?xml version="1.0" encoding="UTF-8"?>
 
<config xmlns="http://www.navercorp.com/request-param">
    <defenders>
        <defender>
            <name>preventer</name>
            <class>com.naver.service.filter.requestparam.defender.XssPreventerDefender</class>
        </defender>
		<defender>
			<!-- XSS Defender 사용 시에는 Lucy XSS Filter에 대한 기본 설정(lucy-xss-superset.xml 정의 등)을 미리 해두어야 한다. -->
			<name>xss</name>
			<class>com.naver.service.filter.requestparam.defender.XssFilterDefender</class>
			<init-param>
				<param-value>true</param-value>
			</init-param>
		</defender>
		<defender>
			<!-- XSS Sax Defender 사용 시에는 Lucy XSS Sax Filter에 대한 기본 설정(lucy-xss-superset-sax.xml 정의 등)을 미리 해두어야 한다. -->
			<name>xss_sax</name>
			<class>com.naver.service.filter.requestparam.defender.XssSaxFilterDefender</class>
			<init-param>
				<param-value>true</param-value>
			</init-param>
		</defender>
    </defenders>
 
    <default>
        <defender>preventer</defender>
    </default>
 
    <global>
        <params>
            <param name="q" useDefender="false" />
            <param name="web" useDefender="true" />
        </params>
    </global>
     
    <url-rule-set>
    	<!--  disable url 테스트 -->
    	<url-rule>
            <url disable="true">/disabletest1.nhn</url>
        </url-rule>
        <url-rule>
            <url disable="false">/disabletest2.nhn</url>  <!-- disable이 false인 설정은 기본이기 때문에 불필요하다 -->
        </url-rule>
        <url-rule>
            <url disable="true">/disabletest3.nhn</url>   <!-- disable이 true이면 아래 parameter 설정은 적용되지 않는다. -->
            <params>
                <param name="query" useDefender="false" />
                <param name="prefix1" usePrefix="true" />
                <param name="prefix2" usePrefix="false" useDefender="false" />   
                <param name="prefix3" usePrefix="true" useDefender="true" />
                <param name="prefix4" usePrefix="true" useDefender="false" />
                <param name="prefix5" usePrefix="false" useDefender="true" />
            </params>
        </url-rule>
        <url-rule>
            <url disable="false">/disabletest4.nhn</url> <!-- disable이 false이기 때문에 params 설정이 적용되어야 한다.-->
            <params>
                <param name="query" useDefender="false" />
                <param name="prefix1" usePrefix="true" />
                <param name="prefix2" usePrefix="false" useDefender="false" />
                <param name="prefix3" usePrefix="true" useDefender="true" />
                <param name="prefix4" usePrefix="true" useDefender="false" />
                <param name="prefix5" usePrefix="false" useDefender="true" />
            </params>
        </url-rule>
        <url-rule>
        	<!--  prefix parameter 테스트 -->
            <url>/search.nhn</url>
            <params>
                <param name="query" useDefender="false" />        <!-- /search.nhn URL에 요청되는 'query' parameter 에 대해서는 filtering을 하지 않음. 서버 코드 내에서 별도 escape 처리를 해야 됨 -->
                <param name="prefix1" usePrefix="true" />         <!-- prefix1로 시작하는 모든 파라메터는 필터링 된다. 굳이 사용할 필요없는 설정이다.  -->
                <param name="prefix2" usePrefix="false" useDefender="false" /> <!-- prefix2로 시작하는 모든 파라메터는 필터링 되지 않는다.  -->
                <param name="prefix3" usePrefix="true" useDefender="true" /> <!-- prefix3로 시작하는 모든 파라메터는 필터링 된다. 굳이 사용할 필요없는 설정이다.  -->
            	<param name="prefix4" usePrefix="true">     <!-- saxfilter로 prefix 기능이 사용한지 확인 -->
            		<defender>xss_sax</defender>
            	</param>
            </params>
        </url-rule>
        <url-rule>
            <url>/tlist/list.nhn</url>
			<params>
				<param name="listId" useDefender="false" />	<!-- 필터 대상에서 제외할 경우. 원본 입력값을 유지하고 싶을 경우 사용하며, 서버 코드 내에서 별도 escape 처리를 해야 됨 -->
				<param name="mode">
					<defender>xss</defender>
				</param>
				<param name="q">
					<defender>xss_sax</defender>
				</param>
			</params>
        </url-rule>
    </url-rule-set>
</config>